<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<title>First Group Project</title>

<!--Google Fonts-->
<link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet">

<!--Reset Stylesheet-->
<link rel="stylesheet" href="assets/css/reset.css">

<!--Bootstrap-->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

<!--CSS Stylesheet-->
<link rel="stylesheet" href="assets/css/style.css">

<!--jQuery-->
<script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>

<!--Moment JS-->
<script src="https://cdn.jsdelivr.net/momentjs/2.12.0/moment.min.js"></script>
</head>

<body>

    <div class="jumbotron jumbotron-fluid" id="jumbo">
        <div class="container">
          <h1 class="display-4">Birthday Tracker</h1>
          <p class="lead">Don't Belated!</p>
        </div>
      </div>

      <form>
        <div class="form-group">
          <label for="exampleFormControlInput1">Name</label>
          <input type="name" class="form-control" id="nameInput" placeholder="Your First and Last Name">
        </div>
        <div class="form-group">
          <label for="exampleFormControlInput1">Email</label>
          <input type="name" class="form-control" id="nameInput" placeholder="Your Email">
        </div>
        <div class="form-group">
          <label for="exampleFormControlInput1">Name</label>
          <input type="name" class="form-control" id="recipientName" placeholder="Recipient's First and Last Name">
        </div>
        <div class="form-group">
          <label for="exampleFormControlInput1">Birthdate</label>
          <input type="birthdate" class="form-control" id="birthdate" placeholder="Recipient's MM/DD/YYYY">
        </div>
        <div class="form-group">
          <label for="exampleFormControlSelect1">Likes</label>
          <select class="form-control" id="likes">
            <option selected>Choose One</option>
            <option>Electronics</option>
            <option>Fashion</option>
            <option>Art</option>
            <option>Home & Garden</option>
            <option>Motors</option>
            <option>Sporting Goods</option>
            <option>Toys & Games</option>
            <option>Movies, TV, & Books</option>
            <option>Music</option>
            <option>Health & Beauty</option>
          </select>
        </div>
        <div class="form-group">
          <label for="exampleFormControlSelect1">Dislikes</label>
          <select class="form-control" id="dislikes">
              <option selected>Choose One</option>
              <option>Electronics</option>
            <option>Fashion</option>
            <option>Art</option>
            <option>Home & Garden</option>
            <option>Motors</option>
            <option>Sporting Goods</option>
            <option>Toys & Games</option>
            <option>Movies, TV, & Books</option>
            <option>Music</option>
            <option>Health & Beauty</option>
          </select>
        </div>
        <input class="btn btn-primary" id="submit" type="submit" value="Submit">
      </form><br>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/momentjs/2.12.0/moment.min.js"></script>
  <script type="text/javascript" src="https://cdn.emailjs.com/sdk/2.3.2/email.min.js"></script>
  <script type="text/javascript">
  var keyword = prompt("What to pull back from eBay?")
      var queryURL = "https://svcs.ebay.com/services/search/FindingService/v1?SECURITY-APPNAME=SamReima-Birthday-PRD-f55b8f5d2-3082faa4&OPERATION-NAME=findItemsByKeywords&SERVICE-VERSION=1.0.0&RESPONSE-DATA-FORMAT=JSON&callback=_cb_findItemsByKeywords&REST-PAYLOAD&keywords="+keyword+"&paginationInput.entriesPerPage=10&GLOBAL-ID=EBAY-US&siteid=0"
      $.ajax({
            url: queryURL,
            dataType: "script"
            });

 //function _cb_findItemsByKeywords(root) {
        //if (keyword == "" || keyword == null){
            //alert("Nothing was entered so nothing will be returned!")
        //}
        //else{
      //var items = root.findItemsByKeywordsResponse[0].searchResult[0].item || [];
      //alert("pulling 3 results of  " + keyword + " back from eBay. ")

      
      $(document).ready(function() {
        for (var i = 0; i < items.length; ++i)   {
        var item = items[i];
        console.log(item)
        var title = item.title;
        var price = item.sellingStatus[0].currentPrice[0].__value__
        var ebayDate = item.listingInfo[0].endTime
        var pic = item.galleryURL;

        var format = "YYYY/MM/DD";
        var convertedDate = moment(ebayDate, format);
        var daysLeft = Math.abs(moment(convertedDate).diff(moment(), "days"));

        if (pic != "http://thumbs1.ebaystatic.com/pict/04040_0.jpg"){
       
        if ($("#gift1Image").attr('src') == "") {
        $("#gift1Image").attr("src", pic);
        $("#gift1Image").attr("height", "250px")
        $("#gift1Image").attr("height", "250px")
        $("#giftTitle1").text(title)
        $("#giftPrice1").text("$ " + price)
        $("#giftDays1").text(daysLeft + " days left")
        }

        else if ($("#gift2Image").attr('src')== "") {
        $("#gift2Image").attr("src", pic);
        $("#gift2Image").attr("height", "250px")
        $("#gift2Image").attr("height", "250px")
        $("#giftTitle2").text(title)
        $("#giftPrice2").text("$ " + price)
        $("#giftDays2").text(daysLeft + " days left")
        }

        else if ($("#gift3Image").attr('src') == "") {
        $("#gift3Image").attr("src", pic);
        $("#gift3Image").attr("height", "250px")
        $("#gift3Image").attr("height", "250px")
        $("#giftTitle3").text(title)
        $("#giftPrice3").text("$ " + price)
        $("#giftDays3").text(daysLeft + " days left")
        }

     }
    }
    });
    var viewitem = item.viewItemURL;
        

     }   
 }
 (function(){
      emailjs.init("user_5PhSrglHUc15780D2cekk");
   })();
   //var email = "example@email.com"
   var template_params = {
   "user_email": email
}

var service_id = "default_service";
var template_id = "bday";
emailjs.send(service_id, template_id, template_params)
    .then(function(response) {
       console.log('SUCCESS!', response.status, response.text);
    }, function(error) {
       console.log('FAILED...', error);
    });
    var imgDiv = $("<img>")
        imgDiv.attr("src", pic);
        imgDiv.attr("height", "250px");
        imgDiv.attr("width", "250px");

var a = moment([current]);
var b = moment([2007, 0, 28]);
var diffInMs = a.diff(b); // 86400000 milliseconds
var diffInDays = a.diff(b, 'days'); // 1 day

  </script>






    <script src="https://www.gstatic.com/firebasejs/5.8.6/firebase.js"></script>
    <script src="assets/javascript/train.js"></script>

    </body>

</html>